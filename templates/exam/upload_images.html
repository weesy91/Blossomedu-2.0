<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>문제 이미지 대량 등록</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">

<div class="container py-5">
    <div class="row justify-content-center">
        <div class="col-md-8">
            <div class="card shadow">
                <div class="card-header bg-primary text-white">
                    <h4 class="mb-0">📸 문제 이미지 대량 업로드</h4>
                </div>
                <div class="card-body p-4">
                    
                    {% if messages %}
                        {% for message in messages %}
                            <div class="alert alert-info">
                                {{ message }}
                            </div>
                        {% endfor %}
                    {% endif %}

                    <form method="POST" enctype="multipart/form-data">
                        {% csrf_token %}
                        
                        <div class="mb-3">
                            <label class="form-label fw-bold">1. 교재 선택</label>
                            <select name="book_name" class="form-select" required>
                                <option value="">교재를 선택하세요</option>
                                {% for book in academy_books %}
                                    <option value="{{ book.title }}">
                                        [{{ book.get_category_display }}] {{ book.title }}
                                    </option>
                                {% endfor %}
                            </select>
                            <div class="form-text text-primary">
                                ※ 목록에 없는 교재는 관리자 페이지에서 먼저 등록해주세요.
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label fw-bold">2. 문제 성격 (비율 조정을 위해 필수)</label>
                            <select name="style" class="form-select" required>
                                <option value="CONCEPT">🟢 개념/이론 (객관식, 빈칸 등)</option>
                                <option value="ANALYSIS">🔴 구문분석/적용 (주관식, 끊어읽기 등)</option>
                            </select>
                            <div class="form-text">
                                * 지금 업로드하는 이미지들이 어떤 유형인지 선택해주세요.
                            </div>
                        </div>
                        <div class="mb-3 p-3 bg-white border rounded">
                            <label class="form-label fw-bold text-danger">3. 독해 유형 (독해 자료 업로드 시에만 선택)</label>
                            <select name="reading_type" class="form-select">
                                <option value="NONE" selected>해당 없음 (구문/개념/어법 업로드 시)</option>
                                <option value="TOPIC">Type A: 대의파악 (주제/제목/요지)</option>
                                <option value="LOGIC">Type B: 논리흐름 (순서/삽입/무관)</option>
                                <option value="BLANK">Type C: 빈칸/함축의미</option>
                                <option value="DETAIL">Type D: 세부내용 (일치/도표/어휘)</option>
                                <option value="STRUCT">Type S: 문장 구조분석 (독해 지문 내 문장)</option>
                            </select>
                            <div class="form-text text-muted">
                                <small>📢 독해(Reading) 문제집 PDF를 올릴 때만 선택하세요. 인쇄 시 해당 유형에 맞는 'Logic Check' 박스가 생성됩니다.</small>
                            </div>
                        </div>
                        <div class="mb-4">
    <label class="form-label fw-bold">4. 문제 파일 업로드 (이미지 or PDF)</label>
    
    <input type="file" name="images" class="form-control" multiple accept="image/*, application/pdf" required>
    
    <div class="alert alert-light border mt-3">
        <h6 class="fw-bold text-dark">📌 파일명 규칙 (둘 중 하나 선택)</h6>
        
                                <div class="mb-2">
                                    <span class="badge bg-primary">방법 A</span> <strong>PDF 통째로 올리기 (추천 👍)</strong><br>
                                    <small class="text-muted">
                                        - 파일명: <code>1강.pdf</code> (숫자가 강 번호가 됨)<br>
                                        - 내용: 1쪽=1번, 2쪽=2번... 순서대로 자동 인식됩니다.<br>
                                        - 해설: <code>1강_답.pdf</code> (파일명에 '답' 포함)
                                    </small>
                                </div>

                                <div>
                                    <span class="badge bg-secondary">방법 B</span> <strong>이미지 낱개로 올리기</strong><br>
                                    <small class="text-muted">
                                        - 파일명: <code>1_01.png</code> (1강 1번)<br>
                                        - 해설: <code>1_01_답.png</code>
                                    </small>
                                </div>
                            </div>
                        </div>

                        <div class="d-grid">
                            <button type="submit" class="btn btn-lg btn-dark">
                                등록 시작 🚀
                            </button>
                        </div>
                    </form>
                </div>
            </div>
            
            <div class="text-center mt-3">
                <a href="/admin/exam/question/" class="btn btn-link text-secondary" target="_blank">
                    등록된 문제 확인하러 가기 &rarr;
                </a>
            </div>
        </div>
    </div>
</div>

</body>
</html>